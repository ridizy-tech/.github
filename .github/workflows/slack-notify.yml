# .github/workflows/slack-notify.yml in ridizy-tech/.github repo
name: Slack Notification

on:
  workflow_call:
    inputs:
      status:
        description: 'Job status (success/failure)'
        required: true
        type: string
      job_name:
        description: 'Name of the job'
        required: true
        type: string
      message:
        description: 'Custom message'
        required: false
        type: string
        default: ''

jobs:
  notify:
    runs-on: self-hosted
    steps:
      - name: Load env file
        run: grep -v '^#' $HOME/.env >> $GITHUB_ENV
      - name: Send Slack Notification
        uses: slackapi/slack-github-action@v1.27.0
        with:
          payload: |
            {
              "text": "${{ inputs.status == 'failure' && '<!channel> ðŸš¨' || 'âœ…' }} *${{ inputs.job_name }}* - ${{ github.repository }}"
            }
        env:
          SLACK_WEBHOOK_URL: ${{ env.SLACK_WEBHOOK_URL }}
